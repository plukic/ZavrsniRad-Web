(function(n,t){typeof define=="function"&&define.amd?define(["exports"],t):typeof exports=="object"&&typeof exports.nodeName!="string"?t(exports):t(n.commonJsStrict={})})(this,function(n){function b(n){if(n in et)return n;for(var i=n[0].toUpperCase()+n.slice(1),t=ft.length;t--;)if(n=ft[t]+i,n in et)return n}function dt(n,t){var i=ot.indexOf(n)>-1?ot:kt,r=i.indexOf(n),u=t/90%i.length;return i[(i.length+r+u%i.length)%i.length]}function y(n,t){n=n||{};for(var i in t)t[i]&&t[i].constructor&&t[i].constructor===Object?(n[i]=n[i]||{},y(n[i],t[i])):n[i]=t[i];return n}function k(n){return y({},n)}function gt(n,t,i){var r;return function(){var u=this,f=arguments,e=function(){r=null;i||n.apply(u,f)},o=i&&!r;clearTimeout(r);r=setTimeout(e,t);o&&n.apply(u,f)}}function d(n){if("createEvent"in document){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0);n.dispatchEvent(t)}else n.fireEvent("onchange")}function t(n,t,i){var u,r;typeof t=="string"&&(u=t,t={},t[u]=i);for(r in t)n.style[r]=t[r]}function r(n,t){n.classList?n.classList.add(t):n.className+=" "+t}function ni(n,t){n.classList?n.classList.remove(t):n.className=n.className.replace(t,"")}function st(n,t){for(var i in t)n.setAttribute(i,t[i])}function h(n){return parseInt(n,10)}function ti(n,t){var i=new Image;return i.style.opacity=0,new Promise(function(r){function u(){i.style.opacity=1;setTimeout(function(){r(i)},1)}i.removeAttribute("crossOrigin");n.match(/^https?:\/\/|^\/\//)&&i.setAttribute("crossOrigin","anonymous");i.onload=function(){t?EXIF.getData(i,function(){u()}):u()};i.src=n})}function ht(n,t){var i=n.naturalWidth,r=n.naturalHeight,u=t||g(n),f;return u&&u>=5&&(f=i,i=r,r=f),{width:i,height:r}}function g(n){return n.exifdata?n.exifdata.Orientation:1}function nt(n,t,i){var u=t.width,f=t.height,r=n.getContext("2d");n.width=t.width;n.height=t.height;r.save();switch(i){case 2:r.translate(u,0);r.scale(-1,1);break;case 3:r.translate(u,f);r.rotate(Math.PI/1);break;case 4:r.translate(0,f);r.scale(1,-1);break;case 5:n.width=f;n.height=u;r.rotate(Math.PI/2);r.scale(1,-1);break;case 6:n.width=f;n.height=u;r.rotate(Math.PI/2);r.translate(0,-f);break;case 7:n.width=f;n.height=u;r.rotate(Math.PI/-2);r.translate(-u,f);r.scale(1,-1);break;case 8:n.width=f;n.height=u;r.translate(0,u);r.rotate(Math.PI/-2)}r.drawImage(t,0,0,u,f);r.restore()}function ii(){var n=this,s=n.options.viewport.type?"cr-vp-"+n.options.viewport.type:null,i,h,u,f,e,o;n.options.useCanvas=n.options.enableOrientation||tt.call(n);n.data={};n.elements={};i=n.elements.boundary=document.createElement("div");u=n.elements.viewport=document.createElement("div");h=n.elements.img=document.createElement("img");f=n.elements.overlay=document.createElement("div");n.options.useCanvas?(n.elements.canvas=document.createElement("canvas"),n.elements.preview=n.elements.canvas):n.elements.preview=n.elements.img;r(i,"cr-boundary");i.setAttribute("aria-dropeffect","none");e=n.options.boundary.width;o=n.options.boundary.height;t(i,{width:e+(isNaN(e)?"":"px"),height:o+(isNaN(o)?"":"px")});r(u,"cr-viewport");s&&r(u,s);t(u,{width:n.options.viewport.width+"px",height:n.options.viewport.height+"px"});u.setAttribute("tabindex",0);r(n.elements.preview,"cr-image");st(n.elements.preview,{alt:"preview","aria-grabbed":"false"});r(f,"cr-overlay");n.element.appendChild(i);i.appendChild(n.elements.preview);i.appendChild(u);i.appendChild(f);r(n.element,"croppie-container");n.options.customClass&&r(n.element,n.options.customClass);ei.call(this);n.options.enableZoom&&ui.call(n);n.options.enableResize&&ri.call(n)}function tt(){return this.options.enableExif&&window.EXIF}function ri(){function h(t){var i,r;(t.button===undefined||t.button===0)&&((t.preventDefault(),a)||(i=n.elements.overlay.getBoundingClientRect(),a=!0,e=t.pageX,o=t.pageY,y=t.currentTarget.className.indexOf("vertical")!==-1?"v":"h",k=i.width,d=i.height,t.touches&&(r=t.touches[0],e=r.pageX,o=r.pageY),window.addEventListener("mousemove",c),window.addEventListener("touchmove",c),window.addEventListener("mouseup",l),window.addEventListener("touchend",l),document.body.style[s]="none"))}function c(r){var u=r.pageX,f=r.pageY,s;r.preventDefault();r.touches&&(s=r.touches[0],u=s.pageX,f=s.pageY);var h=u-e,c=f-o,l=n.options.viewport.height+c,a=n.options.viewport.width+h;y==="v"&&l>=b&&l<=d?(t(i,{height:l+"px"}),n.options.boundary.height+=c,t(n.elements.boundary,{height:n.options.boundary.height+"px"}),n.options.viewport.height+=c,t(n.elements.viewport,{height:n.options.viewport.height+"px"})):y==="h"&&a>=b&&a<=k&&(t(i,{width:a+"px"}),n.options.boundary.width+=h,t(n.elements.boundary,{width:n.options.boundary.width+"px"}),n.options.viewport.width+=h,t(n.elements.viewport,{width:n.options.viewport.width+"px"}));p.call(n);rt.call(n);w.call(n);v.call(n);o=f;e=u}function l(){a=!1;window.removeEventListener("mousemove",c);window.removeEventListener("touchmove",c);window.removeEventListener("mouseup",l);window.removeEventListener("touchend",l);document.body.style[s]=""}var n=this,i=document.createElement("div"),a=!1,y,e,o,b=50,k,d,u,f;r(i,"cr-resizer");t(i,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"});this.options.resizeControls.height&&(u=document.createElement("div"),r(u,"cr-resizer-vertical"),i.appendChild(u));this.options.resizeControls.width&&(f=document.createElement("div"),r(f,"cr-resizer-horisontal"),i.appendChild(f));u&&(u.addEventListener("mousedown",h),u.addEventListener("touchstart",h));f&&(f.addEventListener("mousedown",h),f.addEventListener("touchstart",h));this.elements.boundary.appendChild(i)}function a(n){if(this.options.enableZoom){var t=this.elements.zoomer,i=c(n,4);t.value=Math.max(t.min,Math.min(t.max,i))}}function ui(){function f(){lt.call(n,{value:parseFloat(t.value),origin:new l(n.elements.preview),viewportRect:n.elements.viewport.getBoundingClientRect(),transform:i.parse(n.elements.preview)})}function e(t){var i,r;if(n.options.mouseWheelZoom==="ctrl"&&t.ctrlKey!=!0)return 0;i=t.wheelDelta?t.wheelDelta/1200:t.deltaY?t.deltaY/1060:t.detail?t.detail/-60:0;r=n._currentZoom+i*n._currentZoom;t.preventDefault();a.call(n,r);f.call(n)}var n=this,u=n.elements.zoomerWrap=document.createElement("div"),t=n.elements.zoomer=document.createElement("input");r(u,"cr-slider-wrap");r(t,"cr-slider");t.type="range";t.step="0.0001";t.value=1;t.style.display=n.options.showZoomer?"":"none";t.setAttribute("aria-label","zoom");n.element.appendChild(u);u.appendChild(t);n._currentZoom=1;n.elements.zoomer.addEventListener("input",f);n.elements.zoomer.addEventListener("change",f);n.options.mouseWheelZoom&&(n.elements.boundary.addEventListener("mousewheel",e),n.elements.boundary.addEventListener("DOMMouseScroll",e))}function lt(n){function c(){var n={};n[u]=f.toString();n[o]=s.toString();t(r.elements.preview,n)}var r=this,f=n?n.transform:i.parse(r.elements.preview),y=n?n.viewportRect:r.elements.viewport.getBoundingClientRect(),s=n?n.origin:new l(r.elements.preview);if(r._currentZoom=n?n.value:r._currentZoom,f.scale=r._currentZoom,r.elements.zoomer.setAttribute("aria-valuenow",r._currentZoom),c(),r.options.enforceBoundary){var a=fi.call(r,y),e=a.translate,h=a.origin;f.x>=e.maxX&&(s.x=h.minX,f.x=e.maxX);f.x<=e.minX&&(s.x=h.maxX,f.x=e.minX);f.y>=e.maxY&&(s.y=h.minY,f.y=e.maxY);f.y<=e.minY&&(s.y=h.maxY,f.y=e.minY)}c();at.call(r);v.call(r)}function fi(n){var i=this,t=i._currentZoom,r=n.width,u=n.height,y=i.elements.boundary.clientWidth/2,p=i.elements.boundary.clientHeight/2,f=i.elements.preview.getBoundingClientRect(),e=f.width,o=f.height,s=r/2,h=u/2,c=(s/t-y)*-1,w=c-(e*(1/t)-r*(1/t)),l=(h/t-p)*-1,b=l-(o*(1/t)-u*(1/t)),a=1/t*s,k=e*(1/t)-a,v=1/t*h,d=o*(1/t)-v;return{translate:{maxX:c,minX:w,maxY:l,minY:b},origin:{maxX:k,minX:a,maxY:d,minY:v}}}function w(){var n=this,f=n._currentZoom,a=n.elements.preview.getBoundingClientRect(),e=n.elements.viewport.getBoundingClientRect(),c=i.parse(n.elements.preview.style[u]),v=new l(n.elements.preview),y=e.top-a.top+e.height/2,p=e.left-a.left+e.width/2,r={},s={},h;r.y=y/f;r.x=p/f;s.y=(r.y-v.y)*(1-f);s.x=(r.x-v.x)*(1-f);c.x-=s.x;c.y-=s.y;h={};h[o]=r.x+"px "+r.y+"px";h[u]=c.toString();t(n.elements.preview,h)}function ei(){function b(t,i){var u=n.elements.preview.getBoundingClientRect(),e=r.y+i,o=r.x+t;n.options.enforceBoundary?(f.top>u.top+i&&f.bottom<u.bottom+i&&(r.y=e),f.left>u.left+t&&f.right<u.right+t&&(r.x=o)):(r.y=e,r.x=o)}function k(t){n.elements.preview.setAttribute("aria-grabbed",t);n.elements.boundary.setAttribute("aria-dropeffect",t?"move":"none")}function nt(t){function a(n){switch(n){case c:return[1,0];case u:return[0,1];case l:return[-1,0];case o:return[0,-1]}}var c=37,u=38,l=39,o=40,e,h;t.shiftKey&&(t.keyCode==u||t.keyCode==o)?(e=0,e=t.keyCode==u?parseFloat(n.elements.zoomer.value,10)+parseFloat(n.elements.zoomer.step,10):parseFloat(n.elements.zoomer.value,10)-parseFloat(n.elements.zoomer.step,10),n.setZoom(e)):n.options.enableKeyMovement&&t.keyCode>=37&&t.keyCode<=40&&(t.preventDefault(),h=a(t.keyCode),r=i.parse(n.elements.preview),document.body.style[s]="none",f=n.elements.viewport.getBoundingClientRect(),tt(h))}function tt(i){var e=i[0],h=i[1],f={};b(e,h);f[u]=r.toString();t(n.elements.preview,f);p.call(n);document.body.style[s]="";w.call(n);v.call(n);o=0}function g(t){if((t.button===undefined||t.button===0)&&(t.preventDefault(),!e)){if(e=!0,h=t.pageX,c=t.pageY,t.touches){var u=t.touches[0];h=u.pageX;c=u.pageY}k(e);r=i.parse(n.elements.preview);window.addEventListener("mousemove",l);window.addEventListener("touchmove",l);window.addEventListener("mouseup",y);window.addEventListener("touchend",y);document.body.style[s]="none";f=n.elements.viewport.getBoundingClientRect()}}function l(i){var f,e,v,k;i.preventDefault();f=i.pageX;e=i.pageY;i.touches&&(v=i.touches[0],f=v.pageX,e=v.pageY);var g=f-h,nt=e-c,y={};if(i.type=="touchmove"&&i.touches.length>1){var s=i.touches[0],l=i.touches[1],w=Math.sqrt((s.pageX-l.pageX)*(s.pageX-l.pageX)+(s.pageY-l.pageY)*(s.pageY-l.pageY));o||(o=w/n._currentZoom);k=w/o;a.call(n,k);d(n.elements.zoomer);return}b(g,nt);y[u]=r.toString();t(n.elements.preview,y);p.call(n);c=e;h=f}function y(){e=!1;k(e);window.removeEventListener("mousemove",l);window.removeEventListener("touchmove",l);window.removeEventListener("mouseup",y);window.removeEventListener("touchend",y);document.body.style[s]="";w.call(n);v.call(n);o=0}var n=this,e=!1,h,c,o,f,r;n.elements.overlay.addEventListener("mousedown",g);n.elements.viewport.addEventListener("keydown",nt);n.elements.overlay.addEventListener("touchstart",g)}function p(){if(this.elements){var i=this,r=i.elements.boundary.getBoundingClientRect(),n=i.elements.preview.getBoundingClientRect();t(i.elements.overlay,{width:n.width+"px",height:n.height+"px",top:n.top-r.top+"px",left:n.left-r.left+"px"})}}function v(){var n=this,t=n.get(),i;vt.call(n)&&(n.options.update.call(n,t),n.$&&typeof Prototype=="undefined"?n.$(n.element).trigger("update.croppie",t):(window.CustomEvent?i=new CustomEvent("update",{detail:t}):(i=document.createEvent("CustomEvent"),i.initCustomEvent("update",!0,!0,t)),n.element.dispatchEvent(i)))}function vt(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function it(){var n=this,s=1,r={},h=n.elements.preview,f=null,e=new i(0,0,s),c=new l,a=vt.call(n);a&&!n.data.bound&&(n.data.bound=!0,r[u]=e.toString(),r[o]=c.toString(),r.opacity=1,t(h,r),f=n.elements.preview.getBoundingClientRect(),n._originalImageWidth=f.width,n._originalImageHeight=f.height,n.data.orientation=g(n.elements.img),n.options.enableZoom?rt.call(n,!0):n._currentZoom=s,e.scale=n._currentZoom,r[u]=e.toString(),t(h,r),n.data.points.length?oi.call(n,n.data.points):si.call(n),w.call(n),p.call(n))}function rt(n){var t=this,r=0,f=t.options.maxZoom||1.5,o,s,i=t.elements.zoomer,e=parseFloat(i.value),h=t.elements.boundary.getBoundingClientRect(),u=ht(t.elements.img,t.data.orientation),l=t.elements.viewport.getBoundingClientRect(),v,y;t.options.enforceBoundary&&(v=l.width/u.width,y=l.height/u.height,r=Math.max(v,y));r>=f&&(f=r+1);i.min=c(r,4);i.max=c(f,4);!n&&(e<i.min||e>i.max)?a.call(t,e<i.min?i.min:i.max):n&&(s=Math.max(h.width/u.width,h.height/u.height),o=t.data.boundZoom!==null?t.data.boundZoom:s,a.call(t,o));d(i)}function oi(n){if(n.length!=4)throw"Croppie - Invalid number of points supplied: "+n;var r=this,l=n[2]-n[0],f=r.elements.viewport.getBoundingClientRect(),h=r.elements.boundary.getBoundingClientRect(),c={left:f.left-h.left,top:f.top-h.top},e=f.width/l,v=n[1],y=n[0],p=-1*n[1]+c.top,w=-1*n[0]+c.left,s={};s[o]=y+"px "+v+"px";s[u]=new i(w,p,e).toString();t(r.elements.preview,s);a.call(r,e);r._currentZoom=e}function si(){var n=this,f=n.elements.preview.getBoundingClientRect(),r=n.elements.viewport.getBoundingClientRect(),e=n.elements.boundary.getBoundingClientRect(),o=r.left-e.left,s=r.top-e.top,h=o-(f.width-r.width)/2,c=s-(f.height-r.height)/2,l=new i(h,c,n._currentZoom);t(n.elements.preview,u,l.toString())}function hi(n){var r=this,t=r.elements.canvas,i=r.elements.img,f=t.getContext("2d"),e=tt.call(r),n=r.options.enableOrientation&&n,u;f.clearRect(0,0,t.width,t.height);t.width=i.width;t.height=i.height;e&&!n?(u=g(i),nt(t,i,h(u||0,10))):n&&nt(t,i,n)}function ut(n){var s=this,r=n.points,c=h(r[0]),l=h(r[1]),a=h(r[2]),v=h(r[3]),u=a-c,f=v-l,y=n.circle,i=document.createElement("canvas"),t=i.getContext("2d"),e=n.outputWidth||u,o=n.outputHeight||f,p=n.outputWidth&&n.outputHeight;return outputHeightRatio=1,i.width=e,i.height=o,n.backgroundColor&&(t.fillStyle=n.backgroundColor,t.fillRect(0,0,e,o)),u=Math.min(u,s._originalImageWidth),f=Math.min(f,s._originalImageHeight),t.drawImage(this.elements.preview,c,l,u,f,0,0,e,o),y&&(t.fillStyle="#fff",t.globalCompositeOperation="destination-in",t.beginPath(),t.arc(i.width/2,i.height/2,i.width/2,0,Math.PI*2,!0),t.closePath(),t.fill()),i}function ci(n){var i=n.points,u=document.createElement("div"),f=document.createElement("img"),e=i[2]-i[0],o=i[3]-i[1];return r(u,"croppie-result"),u.appendChild(f),t(f,{left:-1*i[0]+"px",top:-1*i[1]+"px"}),f.src=n.url,t(u,{width:e+"px",height:o+"px"}),u}function li(n){return ut.call(this,n).toDataURL(n.format,n.quality)}function ai(n){var t=this;return new Promise(function(i){ut.call(t,n).toBlob(function(n){i(n)},n.format,n.quality)})}function vi(n){this.elements.img.parentNode&&(Array.prototype.forEach.call(this.elements.img.classList,function(t){n.classList.add(t)}),this.elements.img.parentNode.replaceChild(n,this.elements.img),this.elements.preview=n);this.elements.img=n}function yt(n,t){var i=this,u,r=[],f=null,e=tt.call(i);if(typeof n=="string")u=n,n={};else if(Array.isArray(n))r=n.slice();else{if(typeof n=="undefined"&&i.data.url)return it.call(i),v.call(i),null;u=n.url;r=n.points||[];f=typeof n.zoom=="undefined"?null:n.zoom}return i.data.bound=!1,i.data.url=u||i.data.url,i.data.boundZoom=f,ti(u,e).then(function(u){if(vi.call(i,u),r.length)i.options.relative&&(r=[r[0]*u.naturalWidth/100,r[1]*u.naturalHeight/100,r[2]*u.naturalWidth/100,r[3]*u.naturalHeight/100]);else{var f=ht(u),h=i.elements.viewport.getBoundingClientRect(),s=h.width/h.height,a=f.width/f.height,o,e;a>s?(e=f.height,o=e*s):(o=f.width,e=f.height/s);var c=(f.width-o)/2,l=(f.height-e)/2,y=c+o,p=l+e;i.data.points=[c,l,y,p]}i.data.points=r.map(function(n){return parseFloat(n)});i.options.useCanvas&&hi.call(i,n.orientation||1);it.call(i);v.call(i);t&&t()}).catch(function(n){console.error("Croppie:"+n)})}function c(n,t){return parseFloat(n).toFixed(t||0)}function pt(){var n=this,s=n.elements.preview.getBoundingClientRect(),r=n.elements.viewport.getBoundingClientRect(),u=r.left-s.left,f=r.top-s.top,h=(r.width-n.elements.viewport.offsetWidth)/2,l=(r.height-n.elements.viewport.offsetHeight)/2,e=u+n.elements.viewport.offsetWidth+h,o=f+n.elements.viewport.offsetHeight+l,t=n._currentZoom,i;return(t===Infinity||isNaN(t))&&(t=1),i=n.options.enforceBoundary?0:Number.NEGATIVE_INFINITY,u=Math.max(i,u/t),f=Math.max(i,f/t),e=Math.max(i,e/t),o=Math.max(i,o/t),{points:[c(u),c(f),c(e),c(o)],zoom:t,orientation:n.data.orientation}}function yi(n){var r=this,t=pt.call(r),u=y(k(wt),k(n)),s=typeof n=="string"?n:u.type||"base64",i=u.size||"viewport",e=u.format,h=u.quality,c=u.backgroundColor,l=typeof u.circle=="boolean"?u.circle:r.options.viewport.type==="circle",f=r.elements.viewport.getBoundingClientRect(),o=f.width/f.height;return i==="viewport"?(t.outputWidth=f.width,t.outputHeight=f.height):typeof i=="object"&&(i.width&&i.height?(t.outputWidth=i.width,t.outputHeight=i.height):i.width?(t.outputWidth=i.width,t.outputHeight=i.width/o):i.height&&(t.outputWidth=i.height*o,t.outputHeight=i.height)),bt.indexOf(e)>-1&&(t.format="image/"+e,t.quality=h),t.circle=l,t.url=r.data.url,t.backgroundColor=c,new Promise(function(n){switch(s.toLowerCase()){case"rawcanvas":n(ut.call(r,t));break;case"canvas":case"base64":n(li.call(r,t));break;case"blob":ai.call(r,t).then(n);break;default:n(ci.call(r,t))}})}function pi(){it.call(this)}function wi(n){if(!this.options.useCanvas||!this.options.enableOrientation)throw"Croppie: Cannot rotate without enableOrientation && EXIF.js included";var t=this,i=t.elements.canvas;t.data.orientation=dt(t.data.orientation,n);nt(i,t.elements.img,t.data.orientation);rt.call(t);lt.call(t);copy=null}function bi(){var n=this;n.element.removeChild(n.elements.boundary);ni(n.element,"croppie-container");n.options.enableZoom&&n.element.removeChild(n.elements.zoomerWrap);delete n.elements}function f(n,t){var i,u,e;if(n.className.indexOf("croppie-container")>-1)throw new Error("Croppie: Can't initialize croppie more than once");this.element=n;this.options=y(k(f.defaults),t);this.element.tagName.toLowerCase()==="img"&&(i=this.element,r(i,"cr-original-image"),st(i,{"aria-hidden":"true",alt:""}),u=document.createElement("div"),this.element.parentNode.appendChild(u),u.appendChild(i),this.element=u,this.options.url=this.options.url||i.src);ii.call(this);this.options.url&&(e={url:this.options.url,points:this.options.points},delete this.options.url,delete this.options.points,yt.call(this,e))}var ct,i,l,at,wt,bt,e;if(typeof Promise!="function"){
/*! promise-polyfill 3.1.0 */
!function(n){function i(n,t){return function(){n.apply(t,arguments)}}function t(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=null;this._value=null;this._deferreds=[];o(n,i(f,this),i(r,this))}function u(n){var t=this;return null===this._state?void this._deferreds.push(n):void s(function(){var i=t._state?n.onFulfilled:n.onRejected,r;if(null===i)return void(t._state?n.resolve:n.reject)(t._value);try{r=i(t._value)}catch(u){return void n.reject(u)}n.resolve(r)})}function f(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void o(i(t,n),i(f,this),i(r,this))}this._state=!0;this._value=n;e.call(this)}catch(u){r.call(this,u)}}function r(n){this._state=!1;this._value=n;e.call(this)}function e(){for(var n=0,t=this._deferreds.length;t>n;n++)u.call(this,this._deferreds[n]);this._deferreds=null}function h(n,t,i,r){this.onFulfilled="function"==typeof n?n:null;this.onRejected="function"==typeof t?t:null;this.resolve=i;this.reject=r}function o(n,t,i){var r=!1;try{n(function(n){r||(r=!0,t(n))},function(n){r||(r=!0,i(n))})}catch(u){if(r)return;r=!0;i(u)}}var c=setTimeout,s="function"==typeof setImmediate&&setImmediate||function(n){c(n,1)},l=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};t.prototype["catch"]=function(n){return this.then(null,n)};t.prototype.then=function(n,i){var r=this;return new t(function(t,f){u.call(r,new h(n,i,t,f))})};t.all=function(){var n=Array.prototype.slice.call(1===arguments.length&&l(arguments[0])?arguments[0]:arguments);return new t(function(t,i){function u(r,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if("function"==typeof o)return void o.call(e,function(n){u(r,n)},i)}n[r]=e;0==--f&&t(n)}catch(s){i(s)}}if(0===n.length)return t([]);for(var f=n.length,r=0;r<n.length;r++)u(r,n[r])})};t.resolve=function(n){return n&&"object"==typeof n&&n.constructor===t?n:new t(function(t){t(n)})};t.reject=function(n){return new t(function(t,i){i(n)})};t.race=function(n){return new t(function(t,i){for(var r=0,u=n.length;u>r;r++)n[r].then(t,i)})};t._setImmediateFn=function(n){s=n};"undefined"!=typeof module&&module.exports?module.exports=t:n.Promise||(n.Promise=t)}(this)}typeof CustomEvent!="function"&&function(){function n(n,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var i=document.createEvent("CustomEvent");return i.initCustomEvent(n,t.bubbles,t.cancelable,t.detail),i}n.prototype=window.Event.prototype;window.CustomEvent=n}();HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(n,t,i){for(var u=atob(this.toDataURL(t,i).split(",")[1]),f=u.length,e=new Uint8Array(f),r=0;r<f;r++)e[r]=u.charCodeAt(r);n(new Blob([e],{type:t||"image/png"}))}});var ft=["Webkit","Moz","ms"],et=document.createElement("div").style,ot=[1,8,3,6],kt=[2,7,4,5],o,u,s;u=b("transform");o=b("transformOrigin");s=b("userSelect");ct={translate3d:{suffix:", 0px"},translate:{suffix:""}};i=function(n,t,i){this.x=parseFloat(n);this.y=parseFloat(t);this.scale=parseFloat(i)};i.parse=function(n){return n.style?i.parse(n.style[u]):n.indexOf("matrix")>-1||n.indexOf("none")>-1?i.fromMatrix(n):i.fromString(n)};i.fromMatrix=function(n){var t=n.substring(7).split(",");return t.length&&n!=="none"||(t=[1,0,0,1,0,0]),new i(h(t[4]),h(t[5]),parseFloat(t[0]))};i.fromString=function(n){var r=n.split(") "),t=r[0].substring(f.globals.translate.length+1).split(","),u=r.length>1?r[1].substring(6):1,e=t.length>1?t[0]:0,o=t.length>1?t[1]:0;return new i(e,o,u)};i.prototype.toString=function(){var n=ct[f.globals.translate].suffix||"";return f.globals.translate+"("+this.x+"px, "+this.y+"px"+n+") scale("+this.scale+")"};l=function(n){if(!n||!n.style[o]){this.x=0;this.y=0;return}var t=n.style[o].split(" ");this.x=parseFloat(t[0]);this.y=parseFloat(t[1])};l.prototype.toString=function(){return this.x+"px "+this.y+"px"};at=gt(p,500);wt={type:"canvas",format:"png",quality:1};bt=["jpeg","webp","png"];window.jQuery&&(e=window.jQuery,e.fn.croppie=function(n){var r=typeof n,i,t;return r==="string"?(i=Array.prototype.slice.call(arguments,1),t=e(this).data("croppie"),n==="get")?t.get():n==="result"?t.result.apply(t,i):n==="bind"?t.bind.apply(t,i):this.each(function(){var t=e(this).data("croppie"),r;if(t)if(r=t[n],e.isFunction(r))r.apply(t,i),n==="destroy"&&e(this).removeData("croppie");else throw"Croppie "+n+" method not found";}):this.each(function(){var t=new f(this,n);t.$=e;e(this).data("croppie",t)})});f.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,update:function(){}};f.globals={translate:"translate3d"};y(f.prototype,{bind:function(n,t){return yt.call(this,n,t)},get:function(){var t=pt.call(this),n=t.points;return this.options.relative&&(n[0]/=this.elements.img.naturalWidth/100,n[1]/=this.elements.img.naturalHeight/100,n[2]/=this.elements.img.naturalWidth/100,n[3]/=this.elements.img.naturalHeight/100),t},result:function(n){return yi.call(this,n)},refresh:function(){return pi.call(this)},setZoom:function(n){a.call(this,n);d(this.elements.zoomer)},rotate:function(n){wi.call(this,n)},destroy:function(){return bi.call(this)}});n.Croppie=window.Croppie=f});